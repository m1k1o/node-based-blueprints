<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Node based programming</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="./static/styles.css" />
</head>
<body>
    <div id="app">
        <button @click="newElement()">New</button>
        <button @click="exportModal = true">Import / Export</button>

        <template v-for="(el, index) in elements">
            <node :el="el" v-on:update="saveElement(el, $event);" v-on:dblclick.native="editModal = el"></node>
            
            <modal v-if="editModal == el" @close="saveElement(el);editModal = null" v-bind:el="el">
                <h1 slot="header">Edit node</h1>
                <div slot="body">
                    <h2>General</h2>
                    <ul>
                        <li>Title: <input type="text" v-model="el.title" placeholder="Title"></li>
                        <li>Subtitle: <input type="text" v-model="el.subtitle" placeholder="Subtitle"></li>
                        <li>Color: <select v-model="el.color">
                            <option value="">--default--</option>
                            <option v-for="color in colors">{{ color }}</option>
                        </select></li>
                        <li>Cendered: <input type="checkbox" v-model="el.centered" value="1"></li>
                    </ul>
                    
                    <h2>In</h2>
                    <ul class="">
                        <li v-for="(int_in, index) in el.in">
                            <select v-model="int_in.icon">
                                <option value="">--none--</option>
                                <option>bullet</option>
                                <option>arrow</option>
                            </select>
                            <span v-if="int_in.icon" v-bind:class="int_in.icon"></span>
                            <input type="text" v-model="int_in.text">
                            <button v-on:click="el.in.splice(index, 1);">&times;</button>
                        </li>
                        <li><button v-on:click="el.in.push({});">+</button></li>
                    </ul>

                    <h2>Out</h2>
                    <ul class="">
                        <li v-for="(out, index) in el.out">
                            <input type="text" v-model="out.text"><span v-if="out.icon" v-bind:class="out.icon"></span>
                            <select v-model="out.icon">
                                <option value="">--none--</option>
                                <option>bullet</option>
                                <option>arrow</option>
                            </select>
                            <button v-on:click="el.out.splice(index, 1);">&times;</button>
                        </li>
                        <li><button v-on:click="el.out.push({});">+</button></li>
                    </ul>

                    <button @click="elements.splice(index, 1);">Remove</button>
                </div>
            </modal>
        </template>

        <modal v-if="exportModal" @close="exportModal = false">
            <h1 slot="header">Import / Export</h1>
            <div slot="body">
                <h2>Export</h2>
                <textarea rows="5" style="width: 100%;">{{ JSON.stringify(elements) }}</textarea>
                <h2>Import</h2>
                <textarea rows="5" style="width: 100%;" v-model="importData"></textarea>
                <button @click="dataImport(importData);">Apply changes</button>
            </div>
        </modal>
        
    </div>

    <!-- libs -->
    <script src="./static/vue.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/interactjs@1.3.4/dist/interact.min.js"></script>

    <!-- components -->
    <script src="./static/components/node.js" type="text/javascript"></script>
    <script src="./static/components/modal.js" type="text/javascript"></script>

    <script src="./static/main.js" type="text/javascript"></script>
</body>
</html>